{"code":"!function(t){var e={};function a(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},a.r=function(t){Object.defineProperty(t,\"__esModule\",{value:!0})},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,\"a\",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p=\"\",a(a.s=0)}([function(t,e){var a,s,i,o=[\"#FFB90F\",\"#FF6EB4\",\"#FF4500\",\"#663333\",\"#66ff33\",\"#9900ff\",\"#3300ff\",\"#3366cc\",\"#DC143C\",\"#B5B5B5\",\"#9F79EE\",\"#080808\",\"#ff0099\",\"#003366\",\"#003333\",\"#00FFFF\",\"#525252\",\"#8B2252\",\"#8B5A2B\"],n=null;Date.prototype.Format=function(t){var e={\"h+\":this.getHours(),\"m+\":this.getMinutes(),\"s+\":this.getSeconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+\"\").substr(4-RegExp.$1.length))),e)new RegExp(\"(\"+a+\")\").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:(\"00\"+e[a]).substr((\"\"+e[a]).length)));return t};try{var r={},l=(new BMap.Geolocation,window.location.protocol+\"//\"+window.location.host+\"/public/images/redcar.png\"),h=new BMap.Icon(l,new BMap.Size(28,24),{offset:new BMap.Size(10,25),imageOffset:new BMap.Size(0,0)}),c=new BMap.Marker(new BMap.Point(121.48789949,31.24916171),{icon:h}),u=null,d=new BMap.GeolocationControl;d.addEventListener(\"locationSuccess\",function(t){sessionAjax({type:\"get\",url:\"/api/v1/gps\",success:function(t){if(\"ok\"==t.status){var e=new BMap.Point(t.data.longitude,t.data.latitude);c.setPosition(e),n.centerAndZoom(e,15)}},error:function(){}})}),d.addEventListener(\"locationError\",function(t){alert(t.message)})}catch(t){alert(\"检查网络是否连接\")}function p(){sessionAjax({type:\"get\",url:\"/api/v1/gps\",success:function(t){if(\"ok\"==t.status){var e=new BMap.Point(t.data.longitude,t.data.latitude);c.setPosition(e),null!=u&&u.setPosition(e)}setTimeout(p,3e3)},error:function(){setTimeout(p,3e3)}})}function f(t,e){var a=this;sessionAjax({type:\"get\",url:\"/api/v1/phone\",data:{phone:t},success:function(i){if(i.result){var o=a.phoneType;if(\"中国移动\"==i.result.CardType)a.phoneType=1,s=0;else if(\"中国联通\"==i.result.CardType)a.phoneType=2,s=1;else if(\"中国电信\"==i.result.CardType&&1==confirm(\"检测手机号是\"+i.result.CardType+\" 是否切换设备？\"))return void(window.location.href=\"/cdma?search=\"+t);o!=a.phoneType&&e.ClearUIData(),$(\".inputPhone\").html(i.result.CardType+\" \"+i.result.Province+\" \"+i.result.City).css({color:\"#666\"})}}})}function w(t){var e=this;sessionAjax({type:\"get\",url:\"/api/v1/phone\",data:{phone:t},success:function(a){if(a.result){if(\"中国移动\"==a.result.CardType)e.phoneType=1,s=0;else if(\"中国联通\"==a.result.CardType)e.phoneType=2,s=1;else if(\"中国电信\"==a.result.CardType&&1==confirm(\"检测手机号是\"+a.result.CardType+\" 是否切换设备？\"))return void(window.location.href=\"/cdma?search=\"+t);$(\".inputPhone\").html(a.result.CardType+\" \"+a.result.Province+\" \"+a.result.City).css({color:\"#666\"})}}})}function S(t,e,a,s,o,n,r){i=n;var l=new BMap.Marker(s);t.addOverlay(l);var h=new BMap.Label(e.CELL_ID,{offset:new BMap.Size(-20,-20)});l.setLabel(h);var c=new BMap.Circle(s,parseInt(o),{strokeColor:a,fillColor:a,fillOpacity:1e-6,strokeWeight:2,strokeOpacity:1});t.addOverlay(c);var u={width:350,height:100,title:\"基站: \"+e.CELL_ID,enableMessage:!0,message:n},d=new BMap.InfoWindow(n+\"<br>半径：<font color='red'>\"+o+\"</font>米\",u);l.addEventListener(\"click\",function(){t.openInfoWindow(d,s)}),r&&t.openInfoWindow(d,s)}function C(t,e,a){if(res=r[a.CELL_ID],void 0!=res&&void 0!=res.lon){var i=new BMap.Point(parseFloat(res.lon),parseFloat(res.lat));return S(n,a,e,i,res.radius,res.address,!1),void(0==t&&n.centerAndZoom(i,16))}sessionAjax({type:\"get\",url:\"/api/v1/loc_query?mnc=\"+s+\"&lac=\"+a.TAC+\"&ci=\"+a.CELL_ID,success:function(s){if(\"ok\"==s.status&&0==s.data.errcode){r[a.CELL_ID]=a;var i=new BMap.Point(parseFloat(s.data.lon),parseFloat(s.data.lat));S(n,a,e,i,s.data.radius,s.data.address,!1),0==t&&n.centerAndZoom(i,16)}},error:function(){alert(\"基站查询错误\")}})}var m=0;function y(){var t=(new Date).getTime();m+3e3>t||(m=t,void 0===window.playSound?$(\"#sound\").attr(\"src\",\"/public/audio/7499.wav\"):window.playSound.play(2))}window.onload=function(){$(\"#titleName\").html(\"4G定位\");try{var t=new BMap.Point(121.47,31.23)}catch(t){}var e,r,l;new Vue({delimiters:[\"<%\",\"%>\"],created:function(){$(document).height()<=768&&(this.tableHeight=400),this.setSweepingState(3),this.setFollowingState(3),this.setPositionState(3),this.enableConfig(!1);var t=this;sessionAjax({type:\"get\",url:\"/api/v1/cases/current\",success:function(t){console.log(t)}}),sessionAjax({type:\"get\",url:\"/api/v1/phone/task\",error:function(){t.setSweepingState(0),t.setFollowingState(0),t.setPositionState(0),t.enableConfig(!0)},complete:function(){if(sessionStorage.allStations&&sessionStorage.oldAddStat){const i=JSON.parse(sessionStorage.allStations),o=JSON.parse(sessionStorage.oldAddStat);for(var e=-1,a=0;a<i.length;a++){for(var s=0;s<o.length;s++)if(i[a].CELL_ID==o[s].CELL_ID&&i[a].CellId==o[s].CellId){e=s;break}t.tableData=-1==e?i.concat(o):i}}else sessionStorage.allStations&&\"undefined\"!=sessionStorage.allStations?t.tableData=JSON.parse(sessionStorage.allStations):sessionStorage.oldAddStat&&\"undefined\"!=sessionStorage.oldAddStat&&(t.tableData=JSON.parse(sessionStorage.oldAddStat));setTimeout(t.heart,1e3)},success:function(e){if(console.log(e),e.heart&&(a=e.heart.CilentCount,t.arrFrePci.length<a&&t.addFrePci()),null==e.msg)t.setSweepingState(0),t.setFollowingState(0),t.setPositionState(0),t.enableConfig(!0),sessionStorage.lastname&&\"undefined\"!=sessionStorage.lastname&&(t.input=sessionStorage.lastname,w(t.input),t.targetMatching(t.input));else if(t.input=e.msg.PhoneNumber,w(t.input),t.targetMatching(t.input),0==e.msg.State){if(t.enableConfig(!1),t.MessageCount=e.msg.SendSmsCount,e.logs)for(var s=0;s<e.logs.length;s++){e.logs[s].Id>t.logId&&(t.logId=e.logs[s].Id);var i=e.logs[s].Created.slice(10),o={};if(3==e.logs[s].Type?e.logs[s].typeName=\"操作\":1==e.logs[s].Type?e.logs[s].typeName=\"基站\":2==e.logs[s].Type?e.logs[s].typeName=\"中标\":4==e.logs[s].Type&&(e.logs[s].typeName=\"测向\"),o.Time=i+\" \"+e.logs[s].typeName,o.Type=e.logs[s].typeName,3!=e.logs[s].Type){if(0==new Function(\"var o =\"+e.logs[s].Data+\" ; return o\")().CELL_ID)continue;var n=e.logs[s].Data.slice(1,-1);o.Data=n.replace(\"Frequency\",\"频点\").replace(\"CellId\",\"PCI\").replace(\"CELL_ID\",\"基站ID\").replace(\"OffSysTime\",\"信噪比\").replace(\"Intensitys\",\"强度\").replace(\"TAC\",\"TAC\")}else o.Data=e.logs[s].Data;t.tableData3.unshift(o),t.tableData3.length>250&&(t.tableData3=t.tableData3.slice(0,200));var r=[];1==e.logs[s].Type&&r.push(JSON.parse(e.logs[s].Data));for(var l=0;l<r.length;l++)if(0!=r[l].CELL_ID){for(var h=-1,c=0;c<t.tableData.length;c++)if(t.tableData[c].CELL_ID==r[l].CELL_ID&&t.tableData[c].CellId==r[l].CellId){h=c;break}if(-1==h)t.tableData.push(r[l]);else{for(var u=!1,d=0;d<t.selStations.length;d++)if(r[l].CELL_ID==t.selStations[d].CELL_ID&&t.selStations[d].CellId==r[l].CellId){u=!0;break}Vue.set(t.tableData,h,r[l]),u&&t.selStations.push(r[l])}}var g=[];if(2==e.logs[s].Type){g.push(JSON.parse(e.logs[s].Data));for(var p=0;p<g.length;p++){var f=(new Date).Format(\"hh:mm:ss\");g[p].Created=f,t.tableData2.unshift(g[p])}t.tableData2&&(t.targetCount=t.tableData2.length,t.dataForm.targetFrequency=t.tableData2[0].Frequency,t.dataForm.targetCellId=t.tableData2[0].CellId,t.dataForm.targetRNTI=t.tableData2[0].RNTI.toString(16),t.dataForm.targetTMSI=t.tableData2[0].TMSI.toString(16),0!=t.tableData2[0].TMSI&&(t.dataForm.oldTargetTMSI=\"(\"+t.tableData2[0].TMSI.toString(16)+\")\")),t.dialog&&$(\".dialog_wrapper\").show(),y()}if(4==e.logs[s].Type){t.axisValue=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"];var S=JSON.parse(e.logs[s].Data);t.targetTime=e.logs[s].Created.slice(10);var C=S.Intensitys,m=Math.max.apply(Math,S.Intensitys);switch(S.Intensitys.indexOf(Math.max.apply(null,S.Intensitys))){case 0:t.directionIntensity=\"前方\";break;case 2:t.directionIntensity=\"右方\";break;case 4:t.directionIntensity=\"后方\";break;case 6:t.directionIntensity=\"左方\"}t.distance=m,t.radarMap([1,3,5,7],C)}}2==e.msg.SearchType?(t.setPositionState(3),t.setSweepingState(2),t.setFollowingState(3)):0==e.msg.SearchType?(t.setPositionState(2),t.setSweepingState(3),t.setFollowingState(3)):1==e.msg.SearchType&&(t.setPositionState(3),t.setSweepingState(3),t.setFollowingState(2))}else 3==e.msg.State?(t.enableConfig(!1),t.setPositionState(3),t.setFollowingState(3),t.setSweepingState(3)):(t.enableConfig(!0),t.setPositionState(0),t.setFollowingState(0),t.setSweepingState(0))}})},mounted:function(){try{n=new BMap.Map(\"detailMap\");var e=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE,enableGeolocation:!0});n.addControl(e),n.addControl(d),n.centerAndZoom(t,15),n.enableScrollWheelZoom(),n.addOverlay(c),setTimeout(p,3e3)}catch(t){}var a=360,s=360;$(window).height()<=750&&(a=200,s=200,$(\".radarChart\").css({width:\"335px\"}));var i=[[{axis:\"方向1:\"+this.axis[0],value:this.axisValue[0]},{axis:this.axis[1],value:this.axisValue[1]},{axis:\"方向2:\"+this.axis[2],value:this.axisValue[2]},{axis:this.axis[3],value:this.axisValue[3]},{axis:\"方向3:\"+this.axis[4],value:this.axisValue[4]},{axis:this.axis[5],value:this.axisValue[5]},{axis:\"方向4:\"+this.axis[6],value:this.axisValue[6]},{axis:this.axis[7],value:this.axisValue[7]}]],o=[[{axis:\"方向1:\"+this.axis[0],value:this.axisValue[0]},{axis:this.axis[1],value:this.axisValue[1]},{axis:\"方向2:\"+this.axis[2],value:this.axisValue[2]},{axis:this.axis[3],value:this.axisValue[3]},{axis:\"方向3:\"+this.axis[4],value:this.axisValue[4]},{axis:this.axis[5],value:this.axisValue[5]},{axis:\"方向4:\"+this.axis[6],value:this.axisValue[6]},{axis:this.axis[7],value:this.axisValue[7]}]],r=d3.scale.ordinal().range([\"red\",\"#CC333F\",\"#00A0B0\"]),l={w:180,h:180,margin:{top:30,right:90,bottom:30,left:90},maxValue:250,levels:5,roundStrokes:!0,color:r};RadarChart(\".radarChart\",i,{w:a,h:s,margin:{top:60,right:90,bottom:60,left:90},maxValue:250,levels:5,roundStrokes:!0,color:r}),RadarChart(\".radarChart1\",o,l)},el:\"#basic\",data:{tableHeight:550,axis:[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],axisValue:[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],input:(e=\"search\",r=new RegExp(\"(^|&)\"+e+\"=([^&]*)(&|$)\"),l=window.location.search.substr(1).match(r),null!=l?unescape(l[2]):null),sweepAble:!1,positionAble:!1,followAble:!1,phoneType:\"\",dialogVisible:!1,name:\"\",phonetype:\"\",equipType:\"\",activeName2:\"1\",tableData3:[],tableData2:[],tableData:[],selStations:[],positionable:!0,x:121.48,y:31.22,logId:0,stationId:0,targetId:0,is_listen:!1,is_position_running:!1,is_sweep_running:!1,is_following_running:!1,dataForm:{},dialog:!0,is_senior:!0,targetCount:0,MessageCount:0,targetStation:[],targetTime:\"\",sweepCount:0,distance:0,radio:!1,radioBool:!1,arrFrePci:[],arrFrePciLength:\"\",directionIntensity:\"\",isRunning:\"\",newStatVisible:!1,addNewStation:!1,GoCDMA:!1,checkCDMA:!1,ExitThis:!1,userCHGPASS:!1,chgUserPasswdForm:{},passWordRule:{oldPassword:[{required:!0,message:\"输入旧密码\",trigger:\"blur\"}],newPassword:[{required:!0,message:\"输入新密码\",trigger:\"blur\"}]},setThisTarget:!1,targetForm:{choseCaseValue:\"\"},targetCaseOptions:{},targetCaseId:\"\",targetVisible:!1,targetAddForm:{choseCaseValue:\"\"},targetRules:{Name:[{required:!0,message:\"输入目标姓名\",trigger:\"blur\"}],Phone:[{required:!0,message:\"输入电话号码\",trigger:\"blur\"}]},caseForm:{},caseVisible:!1,caseRules:{Name:[{required:!0,message:\"输入案件名\",trigger:\"blur\"}]}},methods:{ClearUIData:function(){sessionStorage.allStations=[],sessionStorage.oldAddStat=[],this.tableData=[],this.tableData2=[],this.tableData3=[],this.dataForm={},this.targetCount=\"\",this.axis=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],this.axisValue=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"],this.sweepCount=0},addFrePci:function(){this.arrFrePci.length<a&&(this.arrFrePci.push({frequency:\"\",pci:\"\"}),this.addFrePci())},radarMap:function(t,e){var a=360,s=360;$(window).height()<750&&(a=200,s=200,$(\".radarChart\").css({width:\"335px\"}));var i=e.slice();if(function(t,e){var a=0;if(t.length<1)return!1;for(var s=0;s<t.length;s++)s==t.length-1?Math.abs(t[s]-t[0])>10&&a++:Math.abs(t[s]-t[s+1])>10&&a++;return a!=t.length}(e))for(var o=e.indexOf(Math.max.apply(null,e)),n=0;n<e.length;n++)if(0==o){if(n===o){e[n]=Math.floor(1.1*e[o]);continue}if(n===o+1){e[n]=Math.floor(1.1*e[o+1]);continue}if(n===e.length-1){e[n]=Math.floor(1.1*e[e.length-1]);continue}e[n]=Math.floor(.7*e[n])}else{if(n===o){e[n]=Math.floor(1.1*e[o]);continue}if(n===o+1){e[n]=Math.floor(1.1*e[o+1]);continue}if(n===o-1){e[n]=Math.floor(1.1*e[o-1]);continue}e[n]=Math.floor(.7*e[n])}var r=[[{axis:\"方向1:\"+i[0],value:e[0],color:\"red\"},{axis:i[1],value:e[1],color:\"red\"},{axis:\"方向2:\"+i[2],value:e[2],color:\"red\"},{axis:i[3],value:e[3],color:\"red\"},{axis:\"方向3:\"+i[4],value:e[4],color:\"red\"},{axis:i[5],value:e[5],color:\"red\"},{axis:\"方向4:\"+i[6],value:e[6],color:\"red\"},{axis:i[7],value:e[7],color:\"red\"}]],l=[[{axis:\"方向1:\"+i[0],value:e[0],color:\"red\"},{axis:i[1],value:e[1],color:\"red\"},{axis:\"方向2:\"+i[2],value:e[2],color:\"red\"},{axis:i[3],value:e[3],color:\"red\"},{axis:\"方向3:\"+i[4],value:e[4],color:\"red\"},{axis:i[5],value:e[5],color:\"red\"},{axis:\"方向4:\"+i[6],value:e[6],color:\"red\"},{axis:i[7],value:e[7],color:\"red\"}]];if(null!=t)for(var h=0;h<t.length;h++)for(n=0;n<8;n++)n==t[h]&&(r[0][n].color=\"green\",l[0][n].color=\"green\");var c=d3.scale.ordinal().range([\"red\",\"#CC333F\",\"#00A0B0\"]),u={w:180,h:180,margin:{top:30,right:90,bottom:30,left:90},maxValue:250,levels:5,roundStrokes:!0,color:c};RadarChart(\".radarChart\",r,{w:a,h:s,margin:{top:60,right:90,bottom:60,left:90},maxValue:250,levels:5,roundStrokes:!0,color:c}),RadarChart(\".radarChart1\",l,u)},compare:function(t){return function(e,a){return a[t]-e[t]}},phone:function(){11!=this.input.length?($(\".inputPhone\").html(\"请输入正确的手机号\").css({color:\"red\"}),$(\".search .el-input__inner\").css({border:\"1px solid red\"})):($(\".inputPhone\").html(\"\"),$(\".search .el-input__inner\").css({border:\"1px solid #bfcbd9\"}),sessionStorage.lastname=this.input,f(this.input,this),this.targetMatching(this.input))},targetMatching:function(t){var e=this;sessionAjax({type:\"get\",url:\"/api/v1/targets\",data:{phone:t,case_id:-1},success:function(t){null==t.msg?(e.targetVisible=!0,e.getCase()):(e.targetCaseOptions=t.msg,1==e.targetCaseOptions.length?(e.targetCaseId=e.targetCaseOptions[0].Id,sessionAjax({type:\"get\",url:\"/api/v1/cases/setcurrent\",data:{id:Number(e.targetCaseOptions[0].CaseId)},success:function(t){\"ok\"==t.status||alert(t.msg)}})):e.setThisTarget=!0)}})},getCase:function(){var t=this;sessionAjax({type:\"get\",url:\"/api/v1/cases\",success:function(e){console.log(e),\"ok\"==e.status?t.targetCaseOptions=e.msg:alert(e.msg)}})},targetAddClose:function(){this.targetVisible=!1},sureAddTarget:function(){var t=new Object;if(t.Name=this.targetAddForm.Name,t.Phone=this.targetAddForm.Phone,t.Imsi=this.targetAddForm.Imsi,t.Esn=Number(this.targetAddForm.Esn),t.CaseId=Number(this.targetAddForm.choseCaseValue),null!=this.targetCaseOptions)for(var e=0;e<this.targetCaseOptions.length;e++)this.targetAddForm.choseCaseValue==this.targetCaseOptions[e].Id&&(t.CaseName=this.targetCaseOptions[e].Name);if(void 0!=t.Name)if(void 0!=t.Phone)if(\"\"!=t.CaseId){var a=this;sessionAjax({type:\"post\",url:\"/api/v1/targets/add\",data:{data:JSON.stringify(t)},success:function(t){\"err\"==t.status?alert(t.msg):(a.targetMatching(a.input),a.targetVisible=!1)}})}else alert(\"选择案件\");else alert(\"输入电话号码\");else alert(\"输入目标名\")},addCase:function(){this.caseVisible=!0},caseAddClose:function(){this.caseVisible=!1},sureAddCase:function(){var t=this,e=new Object;e.Name=this.caseForm.Name,void 0!=e.Name?sessionAjax({type:\"post\",url:\"/api/v1/cases/add\",data:{data:JSON.stringify(e)},success:function(e){console.log(e),\"err\"==e.status?alert(e.msg):(t.getCase(),t.caseVisible=!1)}}):alert(\"输入案件名\")},setThisTargetClose:function(){this.setThisTarget=!1},sureSetTarget:function(){for(var t=0;t<this.targetCaseOptions.length;t++)this.targetCaseOptions[t].CaseId==this.targetForm.choseCaseValue&&(this.targetCaseId=this.targetCaseOptions[t].Id);var e=this;sessionAjax({type:\"get\",url:\"/api/v1/cases/setcurrent\",data:{id:Number(this.targetForm.choseCaseValue)},success:function(t){\"ok\"==t.status?(alert(\"设置成功\"),e.setThisTarget=!1):alert(t.msg)}})},seniorDown:function(){this.is_senior&&($(\".content\").slideDown(300),$(\"seniorDown\").hide())},seniorUp:function(){$(\".content\").slideUp(300)},SelectionChange:function(t){this.selStations=t},updateStationPos:function(){try{n.clearOverlays(),n.addOverlay(c);for(var t=0;t<this.selStations.length;t++)C(t,o[t],this.selStations[t])}catch(t){}},OnOffCheckAll:function(t){this.updateStationPos()},OnOffCheck:function(t,e){this.updateStationPos()},handleClick:function(t,e){},heart:function(){var t=this;void 0!==window.playSound&&window.playSound.isHidden()?setTimeout(t.heart,1e3):sessionAjax({type:\"get\",url:\"/api/v1/phone/heart\",data:{log_id:t.logId,target_id:t.targetId},complete:function(){setTimeout(t.heart,1e3)},error:function(){t.enableConfig(!0),t.setPositionState(3),t.setFollowingState(3),t.setSweepingState(3)},success:function(e){if(e.heart&&(a=e.heart.CilentCount,t.arrFrePci.length<a&&t.addFrePci()),\"ok\"==e.status){if(0==e.heart.TaskState?(t.enableConfig(!1),0==e.heart.SearchType?(t.setPositionState(2),t.setSweepingState(3),t.setFollowingState(3)):1==e.heart.SearchType?(t.setPositionState(3),t.setSweepingState(3),t.setFollowingState(2)):2==e.heart.SearchType&&(t.setPositionState(3),t.setSweepingState(2),t.setFollowingState(3))):3==e.heart.TaskState?(t.enableConfig(!1),t.setPositionState(3),t.setFollowingState(3),t.setSweepingState(3)):(t.enableConfig(!0),t.setPositionState(0),t.setFollowingState(0),t.setSweepingState(0)),e.logs){t.sweepCount=e.heart.StationCount,t.MessageCount=e.heart.SmsCount;for(var s=0;s<e.logs.length;s++){e.logs[s].Id>t.logId&&(t.logId=e.logs[s].Id);var i=e.logs[s].Created.slice(10),o={};if(3!=e.logs[s].Type){if(0==new Function(\"var o =\"+e.logs[s].Data+\" ; return o\")().CELL_ID)continue;var n=e.logs[s].Data.slice(1,-1);o.Data=n.replace(\"Frequency\",\"频点\").replace(\"CellId\",\"PCI\").replace(\"CELL_ID\",\"基站ID\").replace(\"OffSysTime\",\"信噪比\").replace(\"Intensitys\",\"强度\").replace(\"TAC\",\"TAC\")}else o.Data=e.logs[s].Data;switch(e.logs[s].Type){case 1:e.logs[s].typeName=\"基站\";break;case 2:e.logs[s].typeName=\"中标\";break;case 3:e.logs[s].typeName=\"操作\";break;case 4:e.logs[s].typeName=\"测向\"}o.Time=i+\" \"+e.logs[s].typeName,o.Type=e.logs[s].typeName,t.tableData3.unshift(o),t.tableData3.length>250&&(t.tableData3=t.tableData3.slice(0,200));var r=[];1==e.logs[s].Type&&r.push(JSON.parse(e.logs[s].Data));for(var l=0;l<r.length;l++)if(0!=r[l].CELL_ID){for(var h=-1,c=0;c<t.tableData.length;c++){if(t.tableData[c].CELL_ID==r[l].CELL_ID&&t.tableData[c].CellId==r[l].CellId){h=c;break}if(t.tableData[c].Frequency==r[l].Frequency&&t.tableData[c].CellId==r[l].CellId&&0==t.tableData[c].CELL_ID){h=c;break}}if(-1==h)t.tableData.push(r[l]);else{for(var u=!1,d=0;d<t.selStations.length;d++){if(r[l].CELL_ID==t.selStations[d].CELL_ID&&t.selStations[d].CellId==r[l].CellId){u=!0;break}if(0==t.selStations[d].CELL_ID&&t.selStations[d].CellId==r[l].CellId){u=!0;break}}Vue.set(t.tableData,h,r[l]),u&&t.selStations.push(r[l])}sessionStorage.allStations=JSON.stringify(t.tableData)}var g=[];if(2==e.logs[s].Type){g.push(JSON.parse(e.logs[s].Data));for(var p=0;p<g.length;p++){var f=(new Date).Format(\"hh:mm:ss\");g[p].Created=f,t.tableData2.unshift(g[p])}t.tableData2&&(t.targetCount=t.tableData2.length,t.dataForm.targetFrequency=t.tableData2[0].Frequency,t.dataForm.targetCellId=t.tableData2[0].CellId,t.dataForm.targetRNTI=t.tableData2[0].RNTI.toString(16),t.dataForm.targetTMSI=t.tableData2[0].TMSI.toString(16),0!=t.tableData2[0].TMSI&&(t.dataForm.oldTargetTMSI=\"(\"+t.tableData2[0].TMSI.toString(16)+\")\")),t.dialog&&$(\".dialog_wrapper\").show(),y()}if(4==e.logs[s].Type){t.axisValue=[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"];var w=JSON.parse(e.logs[s].Data);t.targetTime=e.logs[s].Created.slice(10);var S=Math.max.apply(Math,w.Intensitys);switch(w.Intensitys.indexOf(Math.max.apply(null,w.Intensitys))){case 0:t.directionIntensity=\"前方\";break;case 2:t.directionIntensity=\"右方\";break;case 4:t.directionIntensity=\"后方\";break;case 6:t.directionIntensity=\"左方\"}t.distance=S,t.radarMap([1,3,5,7],w.Intensitys)}}}}else t.enableConfig(!0),t.setPositionState(0),t.setFollowingState(0),t.setSweepingState(0),\"没有连接\"==e.msg&&(t.enableConfig(!0),t.setPositionState(3),t.setFollowingState(3),t.setSweepingState(3))}})},search:function(t){var e=this;11==this.input.length?($(\".logbook\").html(\"\"),2!=t&&0!=e.targetStation.length&&sessionStorage.lastname==this.input?sessionAjax({type:\"get\",url:\"/api/v1/phone/search\",data:{phone:this.input,type:t,stations:JSON.stringify(this.selStations),imsi:this.name,phone_type:this.phonetype,equip_type:this.equipType,last_station:JSON.stringify(this.targetStation),is_station:this.radio,target_id:Number(this.targetCaseId)},success:function(a){console.log(a);var s,i=(new Date).Format(\"hh:mm:ss\");if(\"ok\"!=a.status)return(s={}).Time=i,s.Data=a.msg,e.tableData3.push(s),e.enableConfig(!0),e.setPositionState(0),e.setFollowingState(0),void e.setSweepingState(0);switch((s={}).Time=i,t){case 0:s.Data=\"开始定位\";break;case 1:s.Data=\"开始追踪\";break;case 2:s.Data=\"开始扫网\"}e.tableData3.push(s)}}):sessionAjax({type:\"get\",url:\"/api/v1/phone/search\",data:{phone:this.input,type:t,stations:JSON.stringify(this.selStations),imsi:this.name,phone_type:this.phonetype,equip_type:this.equipType,is_station:this.radio,target_id:Number(this.targetCaseId)},success:function(a){console.log(a);var s,i=(new Date).Format(\"hh:mm:ss\");if(\"ok\"!=a.status)return(s={}).Time=i,s.Data=a.msg,e.tableData3.push(s),e.enableConfig(!0),e.setPositionState(0),e.setFollowingState(0),void e.setSweepingState(0);switch((s={}).Time=i,t){case 0:s.Data=\"开始定位\";break;case 1:s.Data=\"开始追踪\";break;case 2:s.Data=\"开始扫网\"}e.tableData3.push(s)}})):($(\".inputPhone\").html(\"请输入正确的手机号\").css({color:\"red\"}),$(\".search .el-input__inner\").css({border:\"1px solid red\"}))},tableRowClassName:function(t,e){return\"操作\"===this.tableData3[e].Type?\"positive-row\":\"中标\"===this.tableData3[e].Type?\"info-row\":\"测向\"===this.tableData3[e].Type?\"direction-row\":\"\"},stationsName:function(t,e){if(e<0||e>=this.tableData.length)return\"\";for(var a=0;a<this.tableData2.length;a++)if(this.tableData[e].Frequency===this.tableData2[a].Frequency&&this.tableData[e].CellId===this.tableData2[a].CellId)return this.dataForm.satCELL_ID=this.tableData[e].CELL_ID,this.dataForm.satOffSysTime=this.tableData[e].OffSysTime,this.dataForm.satIntensity=this.tableData[e].Intensity,this.dataForm.satTAC=this.tableData[e].TAC,this.targetStation=this.tableData[e],this.is_listen||this.dialog&&(this.activeName2=\"2\"),\"on-row\";return\"\"},rightPhone:function(t,e,a,s){null!=this.input?11==this.input.length?(sessionStorage.allStations=[],this.tableData3=[],this.setFollowingState(t),this.setPositionState(e),this.setSweepingState(a),this.seniorUp(),this.search(s)):alert(\"请输入正确11位的手机号\"):($(\".inputPhone\").html(\"请输入正确的手机号\").css({color:\"red\"}),$(\".search .el-input__inner\").css({border:\"1px solid red\"}))},sweeping:function(){try{n.clearOverlays(),n.addOverlay(c)}catch(t){}11==this.input.length&&(this.tableData2=[],this.tableData=[],this.dataForm={},this.targetCount=\"\",this.MessageCount=\"\",this.radarMap(null,this.axis),this.targetStation=[],sessionStorage.oldAddStat=[]),this.rightPhone(3,3,1,2)},position:function(){this.rightPhone(3,1,3,0)},following:function(){this.is_listen=!0,this.rightPhone(1,3,3,1)},stop:function(){sessionStorage.allStations=JSON.stringify(this.tableData),this.setSweepingState(3),this.setFollowingState(3),this.setPositionState(3),this.enableConfig(!1),$(\".search .el-input__inner\").select(),this.is_senior=!0,sessionAjax({type:\"get\",url:\"/api/v1/phone/stop\",success:function(t){}})},stopSweep:function(){this.stop(2)},enableConfig:function(t){t?(this.ExitThis=!1,this.addNewStation=!1,this.radioBool=!1,$(\"#goCDMA\").css({color:\"black\"}),$(\"#content input\").removeAttr(\"readonly\"),$(\"#content input:radio\").removeAttr(\"disabled\")):(this.checkCDMA=!0,this.ExitThis=!0,this.addNewStation=!0,this.radioBool=!0,$(\"#goCDMA\").css({color:\"grey\"}),$(\"#content input\").attr({readonly:\"true\"}),$(\"#content input:radio\").attr({disabled:\"true\"}))},setSweepingState:function(t){0==t?(this.is_sweep_running=!1,this.sweepAble=!0,this.isRunning=!1,$(\".stopSweep\").hide(),$(\".isSweep\").hide(),$(\".sweeping\").show()):1==t?(this.is_sweep_running=!1,this.sweepAble=!1,this.isRunning=!0,$(\".sweeping\").hide(),$(\".stopSweep\").hide(),$(\".isSweep\").show()):2==t?(this.is_sweep_running=!0,this.sweepAble=!0,this.isRunning=!0,$(\".sweeping\").hide(),$(\".isSweep\").hide(),$(\".stopSweep\").show()):3==t&&(this.is_sweep_running=!0,this.sweepAble=!1,$(\".isSweep\").hide(),$(\".stopSweep\").hide(),$(\".sweeping\").show())},stopPosition:function(){this.stop(0)},setPositionState:function(t){0==t?(this.is_position_running=!1,this.positionAble=!0,this.isRunning=!1,$(\".isPosition\").hide(),$(\".stopPosition\").hide(),$(\".position\").show()):1==t?(this.is_position_running=!0,this.positionAble=!1,this.isRunning=!0,$(\".position\").hide(),$(\".stopPosition\").hide(),$(\".isPosition\").show()):2==t?(this.is_position_running=!0,this.positionAble=!0,this.isRunning=!0,$(\".isPosition\").hide(),$(\".position\").hide(),$(\".stopPosition\").show()):3==t&&(this.is_position_running=!0,this.positionAble=!1,$(\".isPosition\").hide(),$(\".stopPosition\").hide(),$(\".position\").show())},stopFollowing:function(){this.stop(1)},setFollowingState:function(t){0==t?(this.is_following_running=!1,this.followAble=!0,this.isRunning=!1,$(\".following\").show(),$(\".stopFollow\").hide(),$(\".isFollow\").hide()):1==t?(this.is_following_running=!0,this.followAble=!1,this.isRunning=!0,$(\".following\").hide(),$(\".stopFollow\").hide(),$(\".isFollow\").show()):2==t?(this.is_following_running=!0,this.followAble=!0,this.isRunning=!0,$(\".following\").hide(),$(\".isFollow\").hide(),$(\".stopFollow\").show()):3==t&&(this.is_following_running=!0,this.followAble=!1,$(\".isFollow\").hide(),$(\".stopFollow\").hide(),$(\".following\").show())},deleteData:function(){this.tableData3=[]},detailTarget:function(){$(\".dialog_wrapper\").show(),this.dialog=!0,this.dialogDrag()},dialogDrag:function(){var t=$(\"#dialog\");document.attachEvent&&g(\"dialog\").attachEvent(\"onselectstart\",function(){return!1});var e=0,a=0,s=0,i=0,o=!1;$(\"#move_part\").mousedown(function(n){n=n||window.event,e=n.pageX,a=n.pageY,s=t.offset().left,i=t.offset().top,o=!0}),$(document).mousemove(function(n){var r=(n=n||window.event).pageX,l=n.pageY;if(o){var h=s+r-e,c=i+l-a,u=$(window).width(),d=$(window).height(),g=u-t.width(),p=d-t.height();h=Math.min(Math.max(0,h),g),c=Math.min(Math.max(0,c),p),t.css({left:h+\"px\",top:c+\"px\"})}}),$(\"#dialog\").mouseup(function(){o=!1})},closeDialog:function(){$(\".dialog_wrapper\").hide(),this.dialog=!1,this.is_listen=!0},closeStatDialog:function(){u=null,$(\".statLocation_wrapper\").hide()},goSet:function(){var t=\"/frequency?bool=\"+this.isRunning+\"&ret=4g#\";void 0===window.playSound?window.location.href=t:window.playSound.goUrl(3,t)},addNewStat:function(){for(var t=0;t<this.arrFrePci.length;t++)this.arrFrePci[t].frequency1=\"\",this.arrFrePci[t].pci1=\"\",this.arrFrePci[t].cellId1=\"\",this.arrFrePci[t].tac1=\"\",this.arrFrePci[t].frequency2=\"\",this.arrFrePci[t].pci2=\"\",this.arrFrePci[t].cellId2=\"\",this.arrFrePci[t].tac2=\"\",this.arrFrePci[t].frequency3=\"\",this.arrFrePci[t].pci3=\"\",this.arrFrePci[t].cellId3=\"\",this.arrFrePci[t].tac3=\"\";this.newStatVisible=!0},handleClose:function(){this.newStatVisible=!1},sureAddNew:function(){for(var t=0;t<this.arrFrePci.length;t++)\"\"!=this.arrFrePci[t].frequency1&&(this.selStations=[]),\"\"!=this.arrFrePci[t].frequency2&&(this.selStations=[]),\"\"!=this.arrFrePci[t].frequency3&&(this.selStations=[]);var e=[];for(t=0;t<this.arrFrePci.length;t++){var a;void 0!=this.arrFrePci[t].pci1&&((a={}).Frequency=parseInt(this.arrFrePci[t].frequency1),\"\"!=this.arrFrePci[t].cellId1&&(a.cellId=parseInt(this.arrFrePci[t].cellId1)),\"\"!=this.arrFrePci[t].tac1&&(a.tac=parseInt(this.arrFrePci[t].tac1)),a.CellId=\"\",a.CellId=parseInt(this.arrFrePci[t].pci1),\"\"==this.arrFrePci[t].pci1||isNaN(this.arrFrePci[t].frequency1)||e.push(a)),void 0!=this.arrFrePci[t].pci2&&((a={}).Frequency=parseInt(this.arrFrePci[t].frequency2),\"\"!=this.arrFrePci[t].cellId2&&(a.cellId=parseInt(this.arrFrePci[t].cellId2)),\"\"!=this.arrFrePci[t].tac2&&(a.tac=parseInt(this.arrFrePci[t].tac2)),a.CellId=\"\",a.CellId=parseInt(this.arrFrePci[t].pci2),\"\"==this.arrFrePci[t].pci2||isNaN(this.arrFrePci[t].frequency2)||e.push(a)),void 0!=this.arrFrePci[t].pci3&&((a={}).Frequency=parseInt(this.arrFrePci[t].frequency3),\"\"!=this.arrFrePci[t].cellId3&&(a.cellId=parseInt(this.arrFrePci[t].cellId3)),\"\"!=this.arrFrePci[t].tac3&&(a.tac=parseInt(this.arrFrePci[t].tac3)),a.CellId=\"\",a.CellId=parseInt(this.arrFrePci[t].pci3),\"\"==this.arrFrePci[t].pci3||isNaN(this.arrFrePci[t].frequency3)||e.push(a))}if(0!=e.length){for(var s=[],i=0;i<e.length;i++){var o={};o.Frequency=e[i].Frequency,o.CellId=e[i].CellId,isNaN(e[i].cellId)?o.CELL_ID=0:o.CELL_ID=e[i].cellId,o.OffSysTime=0,o.Intensity=-170,isNaN(e[i].tac)?o.TAC=0:o.TAC=e[i].tac;for(var n=-1,r=0;r<this.tableData.length;r++)if(this.tableData[r].Frequency==e[i].Frequency&&this.tableData[r].CellId==e[i].CellId){n=r,alert(\"已存在该频点 PCI: \"+e[i].Frequency+\" \"+e[i].CellId);break}-1==n&&(this.radio=!0,s.push(o),this.tableData.push(o)),this.newStatVisible=!1}sessionStorage.oldAddStat=JSON.stringify(s)}},locationStation:function(t,e){f(this.input,this),0!=e.CELL_ID&&0!=e.TAC?sessionAjax({type:\"get\",url:\"/api/v1/loc_query?mnc=\"+s+\"&lac=\"+e.TAC+\"&ci=\"+e.CELL_ID,success:function(t){\"ok\"==t.status?(function(t,e,a){if(null!=a&&null!=e){$(\".statLocation_wrapper\").show();try{var s=new BMap.Map(\"locationDialog\"),i=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT}),o=new BMap.NavigationControl;s.addControl(i),s.addControl(o),s.enableScrollWheelZoom(),s.clearOverlays()}catch(t){}var n=!1,r=null,l=null;a.longitude>1e-4&&a.latitude>1e-4&&(r=new BMap.Point(a.longitude,a.latitude),u=new BMap.Marker(r,{icon:h}),s.addOverlay(u)),null!=e&&0==e.errcode&&(S(s,t,\"red\",l=new BMap.Point(parseFloat(e.lon),parseFloat(e.lat)),e.radius,e.address,!0),s.centerAndZoom(l,16),n=!0),n||null!=u&&s.centerAndZoom(u.getPosition(),15),$(\"#daohangOnce\").on(\"click\",function(){void 0===window.playSound&&void 0==window.playSound.openBMapNavigation||null!=l&&null!=r&&window.playSound.openBMapNavigation(r.lat,r.lng,l.lat,l.lng)})}}(e,t.data,t.pos),$(\".locationAddress\").html(i)):\"err\"==t.status?alert(t.msg):alert(\"无法查到基站\")},error:function(){alert(\"无法查到基站\")}}):alert(\"请输入正确的TAC和基站号\")},goCDMA:function(){this.isRunning||(void 0===window.playSound?location.href=\"/cdma\":window.playSound.goUrl(2,\"/cdma\"))},menuCommand:function(t){switch(t){case\"0\":this.userCHGPASS=!0;break;case\"1\":window.location.href=\"/scan\";break;case\"2\":this.goSet();break;case\"3\":this.exitLogin()}},exitLogin:function(){sessionAjax({type:\"get\",url:\"/api/v1/logout\",success:function(t){\"ok\"==t.status&&(window.location.href=\"/login\")}})},chgPassClose:function(){this.userCHGPASS=!1},sureChgUserPasswd:function(){if(\"\"!=this.chgUserPasswdForm.oldPassword)if(\"\"!=this.chgUserPasswdForm.newPassword){var t=this;sessionAjax({type:\"post\",url:\"/api/v1/profile/chg_pass\",data:{oldpassword:this.chgUserPasswdForm.oldPassword,newpassword:this.chgUserPasswdForm.newPassword},success:function(e){\"ok\"==e.status?t.exitLogin():alert(e.msg)}})}else alert(\"输入新密码\");else alert(\"输入旧密码\")}}})}}]);","extractedComments":[]}